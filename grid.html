<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="bower_components/core-ajax/core-ajax.html"> 
<polymer-element name="grid-content" attributes="url number">
  <template>
    <style>
    :host {
      display: block;
    }

    </style>
        <link href="./css/main.css" rel="stylesheet" >
      <core-ajax auto url="{{url}}" handleAs="json" on-core-response="{{ajaxResponse}}" ></core-ajax> 
        <div class="content">
          <paper-tabs selected="0" selectedindex="0" id="paper_tabs">
            <paper-tab on-click="typeFilter = ''" id="paper_tab3">All</paper-tab>
            <paper-tab on-click="typeFilter = 'hotels'" id="paper_tab2">Hotels</paper-tab>
            <paper-tab on-click="typeFilter = 'destinations'" id="paper_tab1">Destinations</paper-tab>
            <paper-tab on-click="typeFilter = 'attractions'" id="paper_tab" active>Sights</paper-tab>
          </paper-tabs>
          <div ng-controller="MainCtrl" class="col-centered center-block" >
            <ul class="grid" >
              <template repeat="{{item in items}}">
               <template if="{{item.show}}" > 
                  <li class='{{item.type}}'>
                    <div>
                      <a href="{{item.url}}">
                        <span class="title"> {{item.value}} </span>
                        <img class="tow" on-load="{{setImgClass}}" src="{{item.image}}" />
                      </a>
                    </div>
                  </li>
               </template>
              </template>
            </ul>
          </div>
        </div>

  </template>
  <script>
  Polymer({
    ajaxResponse: function(event, ajax) {
      this.items = ajax.response;
      for (i = 0; i < this.number; i++) { 
        this.items[Math.floor(Math.random() * this.items.length)].show = 1;
      }
      console.log(ajax.response);
    },
    attributeChanged: function(attrName, oldVal, newVal) {
    //var newVal = this.getAttribute(attrName);
      console.log(attrName, 'old: ' + oldVal, 'new:', newVal);
    },
    setImgClass: function () { 
        /* the Grid code */              
      $('.grid').find('img.tow').each(function() {
        var imgClass = (this.width / this.height > 1) ? 'wide' : 'tall';
        $(this).addClass(imgClass);
        $(this).removeClass("tow");
      })
    }
  });
  </script>
</polymer-element>
